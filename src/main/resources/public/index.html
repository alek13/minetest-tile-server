<html>
  <head>
    <link rel="stylesheet" href="leaflet.css"/>
    <style>
    body {
        height: 100%;
    }

    #image-map {
      width: 100%;
      height: 100%;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }
    </style>
  </head>
  <body>
    <div id="image-map"></div>

    <script src="leaflet.js"></script>
    <script>
    var crs = L.Util.extend({}, L.CRS.Simple, {
    	//transformation: L.transformation(0.001, 0, -0.001, 0),
    	scale: function (zoom) {
    		return Math.pow(2, zoom-9);
    	}
    });
    
    var map = L.map('image-map', {
      minZoom: 1,
      maxZoom: 13,
      center: [0, 0],
      zoom: 9,
      crs: crs
    });
    
    L.tileLayer('tiles/{z}/{x}/{y}').addTo(map);
    //L.marker([-207, 7]).bindPopup("Spawn").addTo(map);
    
    var playerMapper = player => {
    	L.marker([player.posz/10, player.posx/10]).bindPopup(player.name).addTo(map);
    	console.log(player);
    };
    
    fetch("player")
    .then(res => res.json())
    .then(players => players.forEach(playerMapper));
    </script>

  </body>
</html>
